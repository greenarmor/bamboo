<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Guides, references, and roadmaps for the Bamboo microframework"><link href=https://bamboo.github.io/configuration/overview/ rel=canonical><link href=../../router/ rel=prev><link href=../../cli/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.20"><title>Overview - Bamboo Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.e53b48f4.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#configuration-schema-overview-v10-contract class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Bamboo Documentation" class="md-header__button md-logo" aria-label="Bamboo Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Bamboo Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Overview </span> </div> </div> </div> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/bamboo/bamboo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> bamboo/bamboo </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Bamboo Documentation" class="md-nav__button md-logo" aria-label="Bamboo Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Bamboo Documentation </label> <div class=md-nav__source> <a href=https://github.com/bamboo/bamboo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> bamboo/bamboo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Installation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Install-Bamboo-PHP82/ class=md-nav__link> <span class=md-ellipsis> PHP 8.2 </span> </a> </li> <li class=md-nav__item> <a href=../../Install-Bamboo-PHP83/ class=md-nav__link> <span class=md-ellipsis> PHP 8.3 </span> </a> </li> <li class=md-nav__item> <a href=../../Install-Bamboo-PHP84/ class=md-nav__link> <span class=md-ellipsis> PHP 8.4 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Framework Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Framework Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modules/ class=md-nav__link> <span class=md-ellipsis> Modules </span> </a> </li> <li class=md-nav__item> <a href=../../router/ class=md-nav__link> <span class=md-ellipsis> Router </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3 checked> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Configuration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Overview </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Overview </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#quick-reference class=md-nav__link> <span class=md-ellipsis> Quick reference </span> </a> </li> <li class=md-nav__item> <a href=#schema-details class=md-nav__link> <span class=md-ellipsis> Schema details </span> </a> <nav class=md-nav aria-label="Schema details"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#etcappphp class=md-nav__link> <span class=md-ellipsis> etc/app.php </span> </a> </li> <li class=md-nav__item> <a href=#etcserverphp class=md-nav__link> <span class=md-ellipsis> etc/server.php </span> </a> </li> <li class=md-nav__item> <a href=#etccachephp class=md-nav__link> <span class=md-ellipsis> etc/cache.php </span> </a> </li> <li class=md-nav__item> <a href=#etcmiddlewarephp class=md-nav__link> <span class=md-ellipsis> etc/middleware.php </span> </a> </li> <li class=md-nav__item> <a href=#etcmodulesphp class=md-nav__link> <span class=md-ellipsis> etc/modules.php </span> </a> </li> <li class=md-nav__item> <a href=#etcredisphp class=md-nav__link> <span class=md-ellipsis> etc/redis.php </span> </a> </li> <li class=md-nav__item> <a href=#etcdatabasephp class=md-nav__link> <span class=md-ellipsis> etc/database.php </span> </a> </li> <li class=md-nav__item> <a href=#etchttpphp class=md-nav__link> <span class=md-ellipsis> etc/http.php </span> </a> </li> <li class=md-nav__item> <a href=#etcviewphp class=md-nav__link> <span class=md-ellipsis> etc/view.php </span> </a> </li> <li class=md-nav__item> <a href=#etcmetricsphp class=md-nav__link> <span class=md-ellipsis> etc/metrics.php </span> </a> </li> <li class=md-nav__item> <a href=#etcresiliencephp class=md-nav__link> <span class=md-ellipsis> etc/resilience.php </span> </a> </li> <li class=md-nav__item> <a href=#etcwsphp class=md-nav__link> <span class=md-ellipsis> etc/ws.php </span> </a> </li> <li class=md-nav__item> <a href=#etcauthphp class=md-nav__link> <span class=md-ellipsis> etc/auth.php </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#validation-hooks class=md-nav__link> <span class=md-ellipsis> Validation hooks </span> </a> </li> <li class=md-nav__item> <a href=#migration-and-deprecation-policy class=md-nav__link> <span class=md-ellipsis> Migration and deprecation policy </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../cli/ class="md-nav__link "> <span class=md-ellipsis> CLI </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/jwt-auth-toolkit/ class=md-nav__link> <span class=md-ellipsis> JWT Auth Toolkit </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../tasks/ class="md-nav__link "> <span class=md-ellipsis> Tasks </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Tasks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tasks/config-validation-ci/ class=md-nav__link> <span class=md-ellipsis> Config Validation in CI </span> </a> </li> <li class=md-nav__item> <a href=../../tasks/benchmarks-baseline-dataset/ class=md-nav__link> <span class=md-ellipsis> Benchmarks Baseline Dataset </span> </a> </li> <li class=md-nav__item> <a href=../../tasks/upgrade-guide-config-deprecations/ class=md-nav__link> <span class=md-ellipsis> Upgrade Guide Config Deprecations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../benchmarks/ class="md-nav__link "> <span class=md-ellipsis> Benchmarks </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Benchmarks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../benchmarks/data/20240528-baseline/ class=md-nav__link> <span class=md-ellipsis> Baseline Dataset (2024-05-28) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../starters/ class=md-nav__link> <span class=md-ellipsis> Starters </span> </a> </li> <li class=md-nav__item> <a href=../../OpenSwoole-Compat-and-Fixes/ class=md-nav__link> <span class=md-ellipsis> Compatibility </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex> <span class=md-ellipsis> Upgrade </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Upgrade </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../upgrade/v1.0/ class=md-nav__link> <span class=md-ellipsis> Bamboo v1.0 Upgrade Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex> <span class=md-ellipsis> Roadmap </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Roadmap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../roadmap/v0.3-prep/ class=md-nav__link> <span class=md-ellipsis> v0.3 Prep </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/v0.4-prep/ class=md-nav__link> <span class=md-ellipsis> v0.4 Prep </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/v1.0-prep/ class=md-nav__link> <span class=md-ellipsis> v1.0 Prep </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#quick-reference class=md-nav__link> <span class=md-ellipsis> Quick reference </span> </a> </li> <li class=md-nav__item> <a href=#schema-details class=md-nav__link> <span class=md-ellipsis> Schema details </span> </a> <nav class=md-nav aria-label="Schema details"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#etcappphp class=md-nav__link> <span class=md-ellipsis> etc/app.php </span> </a> </li> <li class=md-nav__item> <a href=#etcserverphp class=md-nav__link> <span class=md-ellipsis> etc/server.php </span> </a> </li> <li class=md-nav__item> <a href=#etccachephp class=md-nav__link> <span class=md-ellipsis> etc/cache.php </span> </a> </li> <li class=md-nav__item> <a href=#etcmiddlewarephp class=md-nav__link> <span class=md-ellipsis> etc/middleware.php </span> </a> </li> <li class=md-nav__item> <a href=#etcmodulesphp class=md-nav__link> <span class=md-ellipsis> etc/modules.php </span> </a> </li> <li class=md-nav__item> <a href=#etcredisphp class=md-nav__link> <span class=md-ellipsis> etc/redis.php </span> </a> </li> <li class=md-nav__item> <a href=#etcdatabasephp class=md-nav__link> <span class=md-ellipsis> etc/database.php </span> </a> </li> <li class=md-nav__item> <a href=#etchttpphp class=md-nav__link> <span class=md-ellipsis> etc/http.php </span> </a> </li> <li class=md-nav__item> <a href=#etcviewphp class=md-nav__link> <span class=md-ellipsis> etc/view.php </span> </a> </li> <li class=md-nav__item> <a href=#etcmetricsphp class=md-nav__link> <span class=md-ellipsis> etc/metrics.php </span> </a> </li> <li class=md-nav__item> <a href=#etcresiliencephp class=md-nav__link> <span class=md-ellipsis> etc/resilience.php </span> </a> </li> <li class=md-nav__item> <a href=#etcwsphp class=md-nav__link> <span class=md-ellipsis> etc/ws.php </span> </a> </li> <li class=md-nav__item> <a href=#etcauthphp class=md-nav__link> <span class=md-ellipsis> etc/auth.php </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#validation-hooks class=md-nav__link> <span class=md-ellipsis> Validation hooks </span> </a> </li> <li class=md-nav__item> <a href=#migration-and-deprecation-policy class=md-nav__link> <span class=md-ellipsis> Migration and deprecation policy </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=configuration-schema-overview-v10-contract>Configuration Schema Overview (v1.0 Contract)<a class=headerlink href=#configuration-schema-overview-v10-contract title="Permanent link">&para;</a></h1> <p>Bamboo treats every file under <code>etc/</code> as part of the stable contract. The following tables document each schema, default values, and environment overrides for the v1.0 release. Use <code>composer validate:config</code> (which calls <code>php bin/bamboo config.validate</code>) to catch drift before deploying.</p> <h2 id=quick-reference>Quick reference<a class=headerlink href=#quick-reference title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>File</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><code>etc/app.php</code></td> <td>Application identity, environment flags, log destination.</td> </tr> <tr> <td><code>etc/server.php</code></td> <td>OpenSwoole HTTP server host, port, worker counts, static file toggle.</td> </tr> <tr> <td><code>etc/cache.php</code></td> <td>Cache directory and route cache path.</td> </tr> <tr> <td><code>etc/middleware.php</code></td> <td>Global, group, and alias definitions for HTTP middleware.</td> </tr> <tr> <td><code>etc/modules.php</code></td> <td>Ordered list of application modules to boot.</td> </tr> <tr> <td><code>etc/redis.php</code></td> <td>Redis connection string and queue name.</td> </tr> <tr> <td><code>etc/database.php</code></td> <td>Optional database connection definitions.</td> </tr> <tr> <td><code>etc/http.php</code></td> <td>HTTP client defaults and named service endpoints.</td> </tr> <tr> <td><code>etc/view.php</code></td> <td>View engine defaults, per-page overrides, and driver definitions.</td> </tr> <tr> <td><code>etc/metrics.php</code></td> <td>Prometheus namespace, storage driver, histogram buckets.</td> </tr> <tr> <td><code>etc/resilience.php</code></td> <td>Request timeouts, circuit breaker thresholds, health checks.</td> </tr> <tr> <td><code>etc/ws.php</code></td> <td>WebSocket server host and port.</td> </tr> <tr> <td><code>etc/auth.php</code></td> <td>JWT authentication defaults and user store configuration.</td> </tr> </tbody> </table> <h2 id=schema-details>Schema details<a class=headerlink href=#schema-details title="Permanent link">&para;</a></h2> <h3 id=etcappphp><code>etc/app.php</code><a class=headerlink href=#etcappphp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment override</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td>string</td> <td><code>Bamboo</code></td> <td><code>APP_NAME</code></td> </tr> <tr> <td><code>env</code></td> <td>string</td> <td><code>local</code></td> <td><code>APP_ENV</code></td> </tr> <tr> <td><code>debug</code></td> <td>bool</td> <td><code>true</code></td> <td><code>APP_DEBUG</code> (parsed as boolean)</td> </tr> <tr> <td><code>key</code></td> <td>string</td> <td>empty string</td> <td><code>APP_KEY</code></td> </tr> <tr> <td><code>log_file</code></td> <td>string</td> <td><code>var/log/app.log</code></td> <td><code>LOG_FILE</code></td> </tr> </tbody> </table> <p>When <code>debug</code> is disabled, <code>app.key</code> must contain a non-empty secret; the configuration validator enforces this requirement.</p> <h3 id=etcserverphp><code>etc/server.php</code><a class=headerlink href=#etcserverphp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment override</th> </tr> </thead> <tbody> <tr> <td><code>host</code></td> <td>string</td> <td><code>127.0.0.1</code></td> <td><code>HTTP_HOST</code></td> </tr> <tr> <td><code>port</code></td> <td>int</td> <td><code>9501</code></td> <td><code>HTTP_PORT</code></td> </tr> <tr> <td><code>workers</code></td> <td>int</td> <td>CPU count</td> <td><code>HTTP_WORKERS</code> (<code>auto</code> uses detected CPU cores)</td> </tr> <tr> <td><code>task_workers</code></td> <td>int</td> <td><code>0</code></td> <td><code>TASK_WORKERS</code></td> </tr> <tr> <td><code>max_requests</code></td> <td>int</td> <td><code>10000</code></td> <td><code>MAX_REQUESTS</code></td> </tr> <tr> <td><code>static_enabled</code></td> <td>bool</td> <td><code>true</code></td> <td><code>STATIC_ENABLED</code></td> </tr> </tbody> </table> <h3 id=etccachephp><code>etc/cache.php</code><a class=headerlink href=#etccachephp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td>string</td> <td><code>var/cache</code></td> <td>Directory for application cache artifacts.</td> </tr> <tr> <td><code>routes</code></td> <td>string</td> <td><code>var/cache/routes.cache.php</code></td> <td>Route cache produced by <code>routes.cache</code>.</td> </tr> </tbody> </table> <h3 id=etcmiddlewarephp><code>etc/middleware.php</code><a class=headerlink href=#etcmiddlewarephp title="Permanent link">&para;</a></h3> <p>Returns an associative array with optional <code>global</code>, <code>groups</code>, and <code>aliases</code> entries. Each value must resolve to fully-qualified class names or alias strings. Modules append to these arrays via <code>ModuleInterface::middleware</code>. See the router contract for ordering semantics.</p> <h3 id=etcmodulesphp><code>etc/modules.php</code><a class=headerlink href=#etcmodulesphp title="Permanent link">&para;</a></h3> <p>Returns a list of module class names implementing <code>Bamboo\Module\ModuleInterface</code>. Modules are loaded in order and participate in the lifecycle described in <code>docs/modules.md</code>.</p> <h3 id=etcredisphp><code>etc/redis.php</code><a class=headerlink href=#etcredisphp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment override</th> </tr> </thead> <tbody> <tr> <td><code>url</code></td> <td>string</td> <td><code>tcp://127.0.0.1:6379</code></td> <td><code>REDIS_URL</code></td> </tr> <tr> <td><code>queue</code></td> <td>string</td> <td><code>jobs</code></td> <td><code>REDIS_QUEUE</code></td> </tr> </tbody> </table> <h3 id=etcdatabasephp><code>etc/database.php</code><a class=headerlink href=#etcdatabasephp title="Permanent link">&para;</a></h3> <p>Optional. When present it must provide a <code>default</code> connection key and a <code>connections</code> map. The stock template configures a MySQL connection using environment variables <code>DB_CONNECTION</code>, <code>DB_HOST</code>, <code>DB_PORT</code>, <code>DB_DATABASE</code>, <code>DB_USERNAME</code>, and <code>DB_PASSWORD</code>.</p> <h3 id=etchttpphp><code>etc/http.php</code><a class=headerlink href=#etchttpphp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>default.timeout</code></td> <td>float</td> <td>Per-request timeout in seconds.</td> </tr> <tr> <td><code>default.headers</code></td> <td>array</td> <td>Key/value pairs applied to every outbound request.</td> </tr> <tr> <td><code>default.retries.max</code></td> <td>int</td> <td>Maximum retry attempts for retriable status codes.</td> </tr> <tr> <td><code>default.retries.base_delay_ms</code></td> <td>int</td> <td>Exponential backoff base delay in milliseconds.</td> </tr> <tr> <td><code>default.retries.status_codes</code></td> <td>array<int></td> <td>HTTP status codes that trigger a retry.</td> </tr> <tr> <td><code>services</code></td> <td>array<string, array></td> <td>Named services with overrides such as <code>base_uri</code> and <code>timeout</code>.</td> </tr> </tbody> </table> <h3 id=etcviewphp><code>etc/view.php</code><a class=headerlink href=#etcviewphp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><code>default</code></td> <td>string</td> <td><code>components</code></td> <td>Engine resolved when no per-page override is configured.</td> </tr> <tr> <td><code>pages.landing</code></td> <td>string|null</td> <td><code>null</code></td> <td>Optional override for the landing route; must reference an engine name when set.</td> </tr> <tr> <td><code>engines.*.driver</code></td> <td>string</td> <td>varies</td> <td>Maps engine names to driver identifiers consumed by the template manager.</td> </tr> </tbody> </table> <p><code>TemplateEngineManager</code> reads this file to decide which renderer should produce HTML for the landing page and any future view surfaces. Custom drivers can be registered in service providers or bootstrap scripts via <code>TemplateEngineManager::extend()</code>; setting <code>view.default</code> or per-page overrides to those names will switch Bamboo to your preferred templating engine without touching route handlers.【F:etc/view.php†L1-L12】【F:src/Web/View/Engine/TemplateEngineManager.php†L7-L93】【F:src/Web/View/LandingPageContent.php†L6-L117】</p> <h3 id=etcmetricsphp><code>etc/metrics.php</code><a class=headerlink href=#etcmetricsphp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment override</th> </tr> </thead> <tbody> <tr> <td><code>namespace</code></td> <td>string</td> <td><code>bamboo</code></td> <td><code>BAMBOO_METRICS_NAMESPACE</code> (not set by default)</td> </tr> <tr> <td><code>storage.driver</code></td> <td>string</td> <td><code>swoole_table</code></td> <td><code>BAMBOO_METRICS_STORAGE</code></td> </tr> <tr> <td><code>storage.swoole_table.value_rows</code></td> <td>int</td> <td><code>16384</code></td> <td>—</td> </tr> <tr> <td><code>storage.swoole_table.string_rows</code></td> <td>int</td> <td><code>2048</code></td> <td>—</td> </tr> <tr> <td><code>storage.swoole_table.string_size</code></td> <td>int</td> <td><code>4096</code></td> <td>—</td> </tr> <tr> <td><code>storage.apcu.prefix</code></td> <td>string</td> <td><code>bamboo_prom</code></td> <td><code>BAMBOO_METRICS_APCU_PREFIX</code></td> </tr> <tr> <td><code>histogram_buckets</code></td> <td>array<string, array\&lt;float>></td> <td>Default buckets keyed by metric name.</td> <td></td> </tr> </tbody> </table> <h3 id=etcresiliencephp><code>etc/resilience.php</code><a class=headerlink href=#etcresiliencephp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment override</th> </tr> </thead> <tbody> <tr> <td><code>timeouts.default</code></td> <td>float</td> <td><code>3.0</code></td> <td><code>BAMBOO_HTTP_TIMEOUT_DEFAULT</code></td> </tr> <tr> <td><code>timeouts.per_route</code></td> <td>array&lt;string, float</td> <td>array&gt;</td> <td><code>['GET /api/httpbin' =&gt; ['timeout' =&gt; 20.0]]</code></td> </tr> <tr> <td><code>circuit_breaker.enabled</code></td> <td>bool</td> <td><code>true</code></td> <td><code>BAMBOO_CIRCUIT_BREAKER_ENABLED</code></td> </tr> <tr> <td><code>circuit_breaker.failure_threshold</code></td> <td>int</td> <td><code>5</code></td> <td><code>BAMBOO_CIRCUIT_BREAKER_FAILURES</code></td> </tr> <tr> <td><code>circuit_breaker.success_threshold</code></td> <td>int</td> <td><code>1</code></td> <td><code>BAMBOO_CIRCUIT_BREAKER_SUCCESS</code></td> </tr> <tr> <td><code>circuit_breaker.cooldown_seconds</code></td> <td>float</td> <td><code>30.0</code></td> <td><code>BAMBOO_CIRCUIT_BREAKER_COOLDOWN</code></td> </tr> <tr> <td><code>circuit_breaker.per_route</code></td> <td>array<string, mixed></td> <td><code>[]</code></td> <td>—</td> </tr> <tr> <td><code>health.dependencies</code></td> <td>array</td> <td><code>[]</code></td> <td>—</td> </tr> </tbody> </table> <p>Per-route overrides accept either a scalar timeout or an array with keys such as <code>timeout</code>, <code>enabled</code>, and thresholds mirroring the default circuit breaker settings. The stock configuration ships with a <code>GET /api/httpbin</code> override set to 20 seconds so the sample concurrent HTTP client endpoint remains usable even when OpenSwoole coroutine wait groups are unavailable.</p> <h3 id=etcwsphp><code>etc/ws.php</code><a class=headerlink href=#etcwsphp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment override</th> </tr> </thead> <tbody> <tr> <td><code>host</code></td> <td>string</td> <td><code>127.0.0.1</code></td> <td><code>WS_HOST</code></td> </tr> <tr> <td><code>port</code></td> <td>int</td> <td><code>9502</code></td> <td><code>WS_PORT</code></td> </tr> </tbody> </table> <h3 id=etcauthphp><code>etc/auth.php</code><a class=headerlink href=#etcauthphp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment override</th> </tr> </thead> <tbody> <tr> <td><code>jwt.secret</code></td> <td>string</td> <td>empty string</td> <td><code>AUTH_JWT_SECRET</code></td> </tr> <tr> <td><code>jwt.ttl</code></td> <td>int</td> <td><code>3600</code></td> <td><code>AUTH_JWT_TTL</code></td> </tr> <tr> <td><code>jwt.issuer</code></td> <td>string</td> <td><code>Bamboo</code></td> <td><code>AUTH_JWT_ISSUER</code></td> </tr> <tr> <td><code>jwt.audience</code></td> <td>string</td> <td><code>BambooUsers</code></td> <td><code>AUTH_JWT_AUDIENCE</code></td> </tr> <tr> <td><code>jwt.storage.driver</code></td> <td>string</td> <td><code>json</code></td> <td><code>AUTH_JWT_STORAGE_DRIVER</code></td> </tr> <tr> <td><code>jwt.storage.path</code></td> <td>string</td> <td><code>var/auth/users.json</code> (JSON driver)</td> <td><code>AUTH_JWT_USER_STORE</code></td> </tr> <tr> <td><code>jwt.registration.enabled</code></td> <td>bool</td> <td><code>true</code></td> <td><code>AUTH_JWT_ALLOW_REGISTRATION</code></td> </tr> <tr> <td><code>jwt.registration.default_roles</code></td> <td>array<string></td> <td><code>[]</code></td> <td>—</td> </tr> </tbody> </table> <p>When deploying authentication in production, ensure <code>AUTH_JWT_SECRET</code> is set before turning off <code>app.debug</code>. The <code>auth.jwt.setup</code> CLI command generates a secret, publishes this configuration file, and seeds a starter JSON user store while leaving alternate drivers untouched so you can run migrations separately.【F:src/Console/Command/AuthJwtSetup.php†L52-L233】</p> <p>Driver-specific environment variables populate the nested <code>jwt.storage.drivers</code> configuration. MySQL and PostgreSQL entries include DSNs, credentials, table names, and sample schema definitions; Firebase and generic NoSQL entries surface credential paths, collection names, and document shapes.【F:etc/auth.php†L20-L181】</p> <h2 id=validation-hooks>Validation hooks<a class=headerlink href=#validation-hooks title="Permanent link">&para;</a></h2> <ul> <li><code>Bamboo\Core\ConfigValidator</code> enforces the schema above. It raises <code>ConfigurationException</code> with aggregated error messages when constraints are violated.</li> <li><code>php bin/bamboo config.validate</code> runs the validator against the current configuration tree and prints the result. The Composer alias <code>composer validate:config</code> is suitable for CI pipelines.</li> <li>PHPUnit coverage in <code>tests/Core/ConfigValidatorTest.php</code> and <code>tests/Console/ConfigValidateCommandTest.php</code> guards the validator behaviour.</li> </ul> <h2 id=migration-and-deprecation-policy>Migration and deprecation policy<a class=headerlink href=#migration-and-deprecation-policy title="Permanent link">&para;</a></h2> <ul> <li>Renaming configuration keys requires a one-minor-release compatibility window. During the window, code must read both the legacy and the new key while emitting <code>E_USER_DEPRECATED</code> notices when the legacy key is used.</li> <li>Removing configuration files or sections is a breaking change and must be reserved for major releases.</li> <li>New configuration files should ship with validation logic and documentation updates across <code>docs/configuration/</code>, the upgrade guide, and the CLI reference.</li> <li>Operators should rerun <code>composer validate:config</code> after every upgrade and before deploying to catch missing env vars or schema drift.</li> </ul> <h1 id=configuration-schema-overview-v10-contract_1>Configuration Schema Overview (v1.0 Contract)<a class=headerlink href=#configuration-schema-overview-v10-contract_1 title="Permanent link">&para;</a></h1> <p>Bamboo loads every PHP array under <code>etc/</code> through <code>Bamboo\Core\Config</code>, normalising the results into a single tree that backs the <code>config()</code> helper and module bootstrap sequence.【F:src/Core/Config.php†L5-L107】 Runtime validation happens during bootstrap via <code>Bamboo\Core\ConfigValidator</code>, so schema changes must remain in lock-step with that guardrail and its PHPUnit coverage.【F:bootstrap/app.php†L10-L30】【F:tests/Core/ConfigValidatorTest.php†L10-L220】</p> <h2 id=loader-behaviour-and-defaults>Loader behaviour and defaults<a class=headerlink href=#loader-behaviour-and-defaults title="Permanent link">&para;</a></h2> <ul> <li><code>Config::loadConfiguration()</code> requires <code>etc/app.php</code>, <code>server.php</code>, <code>cache.php</code>, <code>redis.php</code>, <code>ws.php</code>, and <code>http.php</code>. Optional files (<code>database.php</code>, <code>middleware.php</code>, <code>metrics.php</code>, and <code>resilience.php</code>) fall back to sensible defaults when missing to keep new projects bootable.【F:src/Core/Config.php†L83-L107】</li> <li>When the metrics or resilience configuration files are absent, Bamboo injects in-memory Prometheus storage and baseline timeout/circuit-breaker settings so observability and safeguards still work in local development environments.【F:src/Core/Config.php†L89-L107】</li> <li>When <code>etc/view.php</code> is missing Bamboo falls back to the built-in <code>components</code> driver so the landing page keeps rendering without extra setup.【F:src/Core/Config.php†L83-L107】【F:etc/view.php†L1-L12】</li> <li>Environment variables are read directly inside the configuration files, so the tables below double as the canonical mapping between <code>.env</code> keys and runtime behaviour.</li> </ul> <h2 id=etcappphp_1>etc/app.php<a class=headerlink href=#etcappphp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td>string</td> <td><code>"Bamboo"</code></td> <td><code>APP_NAME</code></td> </tr> <tr> <td><code>env</code></td> <td>string</td> <td><code>"local"</code></td> <td><code>APP_ENV</code></td> </tr> <tr> <td><code>debug</code></td> <td>bool</td> <td><code>true</code> (coerced via <code>FILTER_VALIDATE_BOOLEAN</code>)</td> <td><code>APP_DEBUG</code></td> </tr> <tr> <td><code>key</code></td> <td>string</td> <td>empty string</td> <td><code>APP_KEY</code></td> </tr> <tr> <td><code>log_file</code></td> <td>string (path)</td> <td><code>var/log/app.log</code> relative to the project root</td> <td><code>LOG_FILE</code></td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li><code>ConfigValidator</code> requires <code>app.key</code> to be non-empty whenever <code>app.debug</code> is <code>false</code> to ensure encrypted cookies and signed payloads remain safe in production environments.【F:tests/Core/ConfigValidatorTest.php†L62-L86】</li> </ul> <h2 id=etcserverphp_1>etc/server.php<a class=headerlink href=#etcserverphp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>host</code></td> <td>non-empty string</td> <td><code>"127.0.0.1"</code></td> <td><code>HTTP_HOST</code></td> </tr> <tr> <td><code>port</code></td> <td>integer 1–65535</td> <td><code>9501</code></td> <td><code>HTTP_PORT</code></td> </tr> <tr> <td><code>workers</code></td> <td>positive integer</td> <td>CPU core count (auto-detected)</td> <td><code>HTTP_WORKERS</code> (<code>"auto"</code> keeps detection)</td> </tr> <tr> <td><code>task_workers</code></td> <td>integer ≥ 0</td> <td><code>0</code></td> <td><code>TASK_WORKERS</code></td> </tr> <tr> <td><code>max_requests</code></td> <td>integer ≥ 1</td> <td><code>10000</code></td> <td><code>MAX_REQUESTS</code></td> </tr> <tr> <td><code>static_enabled</code></td> <td>bool</td> <td><code>true</code></td> <td><code>STATIC_ENABLED</code></td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li>Worker auto-scaling calls OpenSwoole helpers (or <code>nproc</code>) during bootstrap, so container images must allow that detection step to execute.【F:etc/server.php†L3-L18】</li> <li>Validation enforces that <code>server.host</code> is non-empty and the port falls within the TCP range before the HTTP server starts listening.【F:tests/Core/ConfigValidatorTest.php†L18-L41】</li> </ul> <h2 id=etcwsphp_1>etc/ws.php<a class=headerlink href=#etcwsphp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>host</code></td> <td>non-empty string</td> <td><code>"127.0.0.1"</code></td> <td><code>WS_HOST</code></td> </tr> <tr> <td><code>port</code></td> <td>integer 1–65535</td> <td><code>9502</code></td> <td><code>WS_PORT</code></td> </tr> </tbody> </table> <h2 id=etcauthphp_1>etc/auth.php<a class=headerlink href=#etcauthphp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>jwt.secret</code></td> <td>string</td> <td><code>""</code></td> <td><code>AUTH_JWT_SECRET</code></td> </tr> <tr> <td><code>jwt.ttl</code></td> <td>positive integer</td> <td><code>3600</code></td> <td><code>AUTH_JWT_TTL</code></td> </tr> <tr> <td><code>jwt.issuer</code></td> <td>string</td> <td><code>"Bamboo"</code></td> <td><code>AUTH_JWT_ISSUER</code></td> </tr> <tr> <td><code>jwt.audience</code></td> <td>string</td> <td><code>"BambooUsers"</code></td> <td><code>AUTH_JWT_AUDIENCE</code></td> </tr> <tr> <td><code>jwt.storage.driver</code></td> <td>string</td> <td><code>"json"</code></td> <td><code>AUTH_JWT_STORAGE_DRIVER</code></td> </tr> <tr> <td><code>jwt.storage.path</code></td> <td>string (path)</td> <td><code>"var/auth/users.json"</code> (JSON driver)</td> <td><code>AUTH_JWT_USER_STORE</code></td> </tr> <tr> <td><code>jwt.registration.enabled</code></td> <td>bool</td> <td><code>true</code></td> <td><code>AUTH_JWT_ALLOW_REGISTRATION</code></td> </tr> <tr> <td><code>jwt.registration.default_roles</code></td> <td>array<string></td> <td><code>[]</code></td> <td>—</td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li>The scaffolded <code>auth.jwt.setup</code> command publishes this configuration, ensures <code>AUTH_JWT_SECRET</code> is generated, and seeds a default <code>admin</code> user when the JSON driver is active. Alternate drivers are left untouched so you can apply the included schema guidance yourself. Rotate the secret whenever credentials change to invalidate old tokens.【F:src/Console/Command/AuthJwtSetup.php†L52-L233】【F:etc/auth.php†L20-L181】</li> <li>Driver-specific environment variables feed the nested storage definitions: MySQL and PostgreSQL include DSNs, credentials, and SQL schema stubs, while Firebase and generic NoSQL entries surface credential locations and document structures.【F:etc/auth.php†L20-L181】</li> <li>When <code>app.debug</code> is disabled, the configuration validator requires <code>jwt.secret</code> to be non-empty, mirroring the enforcement applied to <code>app.key</code>.</li> </ul> <h2 id=etccachephp_1>etc/cache.php<a class=headerlink href=#etccachephp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>path</code></td> <td>string (directory)</td> <td><code>var/cache</code> relative to the project root</td> <td>—</td> </tr> <tr> <td><code>routes</code></td> <td>string (file path)</td> <td><code>var/cache/routes.cache.php</code> relative to the project root</td> <td>—</td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li><code>ConfigValidator</code> guarantees that <code>cache.routes</code> is a non-empty string so the route caching command cannot silently fail when writing to disk.【F:tests/Core/ConfigValidatorTest.php†L42-L55】</li> </ul> <h2 id=etcredisphp_1>etc/redis.php<a class=headerlink href=#etcredisphp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>url</code></td> <td>non-empty string</td> <td><code>"tcp://127.0.0.1:6379"</code></td> <td><code>REDIS_URL</code></td> </tr> <tr> <td><code>queue</code></td> <td>non-empty string</td> <td><code>"jobs"</code></td> <td><code>REDIS_QUEUE</code></td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li>Application feature tests seed <code>REDIS_URL</code> with an in-memory driver to assert queue behaviour end-to-end, so keep the key stable for test fixtures and operator overrides.【F:tests/Http/ApplicationRoutesTest.php†L20-L74】</li> </ul> <h2 id=etcdatabasephp_1>etc/database.php<a class=headerlink href=#etcdatabasephp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>default</code></td> <td>string</td> <td><code>"mysql"</code></td> <td><code>DB_CONNECTION</code></td> </tr> <tr> <td><code>connections.mysql.driver</code></td> <td>string</td> <td><code>"mysql"</code></td> <td>—</td> </tr> <tr> <td><code>connections.mysql.host</code></td> <td>non-empty string</td> <td><code>"127.0.0.1"</code></td> <td><code>DB_HOST</code></td> </tr> <tr> <td><code>connections.mysql.port</code></td> <td>string/integer</td> <td><code>"3306"</code></td> <td><code>DB_PORT</code></td> </tr> <tr> <td><code>connections.mysql.database</code></td> <td>string</td> <td><code>"app"</code></td> <td><code>DB_DATABASE</code></td> </tr> <tr> <td><code>connections.mysql.username</code></td> <td>string</td> <td><code>"root"</code></td> <td><code>DB_USERNAME</code></td> </tr> <tr> <td><code>connections.mysql.password</code></td> <td>string</td> <td>empty string</td> <td><code>DB_PASSWORD</code></td> </tr> <tr> <td><code>connections.mysql.charset</code></td> <td>string</td> <td><code>"utf8mb4"</code></td> <td>—</td> </tr> <tr> <td><code>connections.mysql.collation</code></td> <td>string</td> <td><code>"utf8mb4_unicode_ci"</code></td> <td>—</td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li>The configuration ships a single MySQL connection stub. Additional connections should use the same nested structure so <code>config('database.connections.*')</code> remains predictable for packages that extend the database layer.【F:etc/database.php†L3-L16】</li> </ul> <h2 id=etchttpphp_1>etc/http.php<a class=headerlink href=#etchttpphp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>default.timeout</code></td> <td>positive float</td> <td><code>5.0</code></td> <td>—</td> </tr> <tr> <td><code>default.headers.User-Agent</code></td> <td>string</td> <td><code>"Bamboo-HTTP/1.0"</code></td> <td>—</td> </tr> <tr> <td><code>default.retries.max</code></td> <td>positive integer</td> <td><code>2</code></td> <td>—</td> </tr> <tr> <td><code>default.retries.base_delay_ms</code></td> <td>integer ≥ 0</td> <td><code>150</code></td> <td>—</td> </tr> <tr> <td><code>default.retries.status_codes</code></td> <td>list<int></td> <td><code>[429, 500, 502, 503, 504]</code></td> <td>—</td> </tr> <tr> <td><code>services.httpbin.base_uri</code></td> <td>string (URL)</td> <td><code>"https://httpbin.org"</code></td> <td>—</td> </tr> <tr> <td><code>services.httpbin.timeout</code></td> <td>positive float</td> <td><code>5.0</code></td> <td>—</td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li><code>ConfigValidator</code> enforces a positive HTTP timeout to prevent zero-delay requests from overwhelming downstream services.【F:tests/Core/ConfigValidatorTest.php†L56-L79】</li> <li>Additional HTTP client profiles should follow the <code>services.{name}</code> pattern so dependency injection remains straightforward.</li> </ul> <h2 id=etcmetricsphp_1>etc/metrics.php<a class=headerlink href=#etcmetricsphp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>namespace</code></td> <td>non-empty string</td> <td><code>"bamboo"</code></td> <td>—</td> </tr> <tr> <td><code>storage.driver</code></td> <td>non-empty string</td> <td><code>"swoole_table"</code></td> <td><code>BAMBOO_METRICS_STORAGE</code></td> </tr> <tr> <td><code>storage.swoole_table.value_rows</code></td> <td>positive integer</td> <td><code>16384</code></td> <td>—</td> </tr> <tr> <td><code>storage.swoole_table.string_rows</code></td> <td>positive integer</td> <td><code>2048</code></td> <td>—</td> </tr> <tr> <td><code>storage.swoole_table.string_size</code></td> <td>positive integer</td> <td><code>4096</code></td> <td>—</td> </tr> <tr> <td><code>storage.apcu.prefix</code></td> <td>string</td> <td><code>"bamboo_prom"</code></td> <td><code>BAMBOO_METRICS_APCU_PREFIX</code></td> </tr> <tr> <td><code>histogram_buckets.default</code></td> <td>list<float></td> <td><code>[0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0]</code></td> <td>—</td> </tr> <tr> <td><code>histogram_buckets.bamboo_http_request_duration_seconds</code></td> <td>list<float></td> <td><code>[0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0]</code></td> <td>—</td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li>The metrics namespace feeds directly into the Prometheus collectors used by <code>HttpMetrics</code> and <code>CircuitBreakerMetrics</code>, so renaming it will change emitted timeseries labels.【F:etc/metrics.php†L1-L44】【F:tests/Roadmap/V0_4/TimeoutMiddlewareTest.php†L24-L66】</li> <li>Validation checks that namespace, driver, and bucket arrays are shaped correctly to catch typos before metrics collection begins.【F:tests/Core/ConfigValidatorTest.php†L88-L165】</li> </ul> <h2 id=etcresiliencephp_1>etc/resilience.php<a class=headerlink href=#etcresiliencephp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>timeouts.default</code></td> <td>positive float</td> <td><code>3.0</code></td> <td><code>BAMBOO_HTTP_TIMEOUT_DEFAULT</code> (optional)</td> </tr> <tr> <td><code>timeouts.per_route</code></td> <td>array&lt;string, float</td> <td>array{timeout?:float}&gt;</td> <td>empty array</td> </tr> <tr> <td><code>circuit_breaker.enabled</code></td> <td>bool</td> <td><code>true</code></td> <td><code>BAMBOO_CIRCUIT_BREAKER_ENABLED</code></td> </tr> <tr> <td><code>circuit_breaker.failure_threshold</code></td> <td>positive integer</td> <td><code>5</code></td> <td><code>BAMBOO_CIRCUIT_BREAKER_FAILURES</code></td> </tr> <tr> <td><code>circuit_breaker.cooldown_seconds</code></td> <td>float ≥ 0</td> <td><code>30.0</code></td> <td><code>BAMBOO_CIRCUIT_BREAKER_COOLDOWN</code></td> </tr> <tr> <td><code>circuit_breaker.success_threshold</code></td> <td>positive integer</td> <td><code>1</code></td> <td><code>BAMBOO_CIRCUIT_BREAKER_SUCCESS</code></td> </tr> <tr> <td><code>circuit_breaker.per_route</code></td> <td>array<string, mixed></td> <td>empty array</td> <td>—</td> </tr> <tr> <td><code>health.dependencies</code></td> <td>array<string, mixed></td> <td>empty array</td> <td>—</td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li>Timeout and circuit-breaker overrides are keyed by the router's <code>METHOD /path</code> notation so middleware can map telemetry to specific routes.【F:etc/resilience.php†L6-L26】【F:tests/Roadmap/V0_4/TimeoutMiddlewareTest.php†L24-L85】</li> <li>Validation checks numeric ranges and per-route overrides to prevent misconfigured resilience policies from reaching production.【F:tests/Core/ConfigValidatorTest.php†L126-L220】</li> </ul> <h2 id=etcmiddlewarephp_1>etc/middleware.php<a class=headerlink href=#etcmiddlewarephp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td><code>global</code></td> <td>list<class-string></td> <td>Request/metrics/resilience middleware stack</td> <td>—</td> </tr> <tr> <td><code>groups.web</code></td> <td>list<class-string></td> <td><code>Bamboo\Web\Middleware\SignatureHeader::class</code></td> <td>—</td> </tr> <tr> <td><code>aliases</code></td> <td>array<string, class-string></td> <td>empty array</td> <td>—</td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li>Modules contribute additional middleware via <code>Config::mergeMiddleware()</code>, and the module lifecycle test suite locks in the merge order to protect downstream applications.【F:etc/middleware.php†L1-L28】【F:src/Core/Config.php†L24-L82】【F:tests/Core/ApplicationModulesTest.php†L23-L60】</li> </ul> <h2 id=etcmodulesphp_1>etc/modules.php<a class=headerlink href=#etcmodulesphp_1 title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Key</th> <th>Type</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td>root value</td> <td>list<class-string\&lt;moduleinterface>></td> <td>empty list</td> <td>—</td> </tr> </tbody> </table> <p><strong>Notes</strong></p> <ul> <li><code>bootstrap/app.php</code> fails fast if the file returns anything other than an array of class strings, ensuring module registration is deterministic during bootstrap.【F:bootstrap/app.php†L22-L30】</li> </ul> <h2 id=cross-file-considerations>Cross-file considerations<a class=headerlink href=#cross-file-considerations title="Permanent link">&para;</a></h2> <ul> <li>Middleware and resilience policies are tightly coupled: the default middleware pipeline wires <code>HttpMetricsCollector</code>, <code>CircuitBreakerMiddleware</code>, and <code>TimeoutMiddleware</code>, which read from both <code>etc/middleware.php</code> and <code>etc/resilience.php</code>. Changing one file without updating the other can cause runtime mismatches in metrics labels or resilience defaults.【F:etc/middleware.php†L17-L28】【F:etc/resilience.php†L6-L26】</li> <li>Queue-heavy routes depend on <code>redis.queue</code> for naming conventions in tests and background workers. Keep the queue key aligned with any worker configuration or job dispatch code that reads <code>config('redis.queue')</code>.【F:tests/Http/ApplicationRoutesTest.php†L52-L74】</li> <li>Metrics configuration interacts with route instrumentation; updating histogram buckets should be coordinated with alert thresholds and any downstream metrics aggregation pipelines.【F:etc/metrics.php†L31-L41】【F:tests/Roadmap/V0_4/MetricsEndpointTest.php†L18-L44】</li> </ul> <h2 id=validation-and-tooling-roadmap>Validation and tooling roadmap<a class=headerlink href=#validation-and-tooling-roadmap title="Permanent link">&para;</a></h2> <ul> <li><strong>Runtime enforcement</strong> – <code>bootstrap/app.php</code> validates configuration on every bootstrap. All errors are emitted to standard error before the process aborts, preventing partial boots with invalid settings.【F:bootstrap/app.php†L10-L30】</li> <li><strong>Composer script (planned)</strong> – add a <code>"validate:config"</code> script entry to <code>composer.json</code> that runs <code>php bin/config-validate</code>, a thin wrapper invoking <code>ConfigValidator</code> against <code>etc/</code>. The script will:</li> <li>bootstrap Composer autoloading;</li> <li>instantiate <code>Config</code> and <code>ConfigValidator</code>;</li> <li>exit with code <code>1</code> when validation fails (after printing aggregated messages). Integrate the command into CI pipelines and pre-deploy hooks so operators can catch schema drift without booting the application.</li> <li><strong>PHPUnit coverage</strong> – <code>tests/Core/ConfigValidatorTest.php</code> exercises all guard rails, from HTTP timeout ranges to circuit-breaker thresholds, while <code>tests/Core/ApplicationModulesTest.php</code> verifies middleware merging behaviour that depends on the configuration tree. Keep new configuration keys backed by similar tests before marking the schema stable.【F:tests/Core/ConfigValidatorTest.php†L10-L220】【F:tests/Core/ApplicationModulesTest.php†L23-L60】</li> </ul> <h2 id=migration-and-deprecation-policy_1>Migration and deprecation policy<a class=headerlink href=#migration-and-deprecation-policy_1 title="Permanent link">&para;</a></h2> <ul> <li><strong>Key renames</strong> – ship shims that read both the legacy and replacement keys. Deprecations should emit a log entry when the old key is used and remove the shim no earlier than the next minor release. Document the overlap window in the upgrade guide and release notes.</li> <li><strong>Feature-flagged fallbacks</strong> – introduce new behaviour behind opt-in flags. Keep defaults aligned with previous releases until the feature graduates, then flip the default in a minor release with clear migration instructions.</li> <li><strong>Communication requirements</strong> – every configuration migration must surface in release notes, the roadmap tracking issue, and the dedicated upgrade guide section. When runtime shims log notices, include actionable remediation steps and links to relevant documentation.</li> <li><strong>Validation alignment</strong> – update <code>ConfigValidator</code> (and its tests) alongside any schema change. The composer validation command should be updated in the same pull request so CI immediately guards the new contract.</li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.expand", "navigation.indexes", "navigation.sections"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>