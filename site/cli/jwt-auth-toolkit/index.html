<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Guides, references, and roadmaps for the Bamboo microframework"><link href=https://greenarmor.github.io/bamboo/cli/jwt-auth-toolkit/ rel=canonical><link href=../ rel=prev><link href=../../tasks/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.20"><title>JWT Auth Toolkit - Bamboo Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.e53b48f4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#jwt-authentication-cli-toolkit class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Bamboo Documentation" class="md-header__button md-logo" aria-label="Bamboo Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Bamboo Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> JWT Auth Toolkit </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/greenarmor/bamboo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> greenarmor/bamboo </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Bamboo Documentation" class="md-nav__button md-logo" aria-label="Bamboo Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Bamboo Documentation </label> <div class=md-nav__source> <a href=https://github.com/greenarmor/bamboo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> greenarmor/bamboo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Installation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Install-Bamboo-PHP82/ class=md-nav__link> <span class=md-ellipsis> PHP 8.2 </span> </a> </li> <li class=md-nav__item> <a href=../../Install-Bamboo-PHP83/ class=md-nav__link> <span class=md-ellipsis> PHP 8.3 </span> </a> </li> <li class=md-nav__item> <a href=../../Install-Bamboo-PHP84/ class=md-nav__link> <span class=md-ellipsis> PHP 8.4 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Framework Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Framework Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modules/ class=md-nav__link> <span class=md-ellipsis> Modules </span> </a> </li> <li class=md-nav__item> <a href=../../router/ class=md-nav__link> <span class=md-ellipsis> Router </span> </a> </li> <li class=md-nav__item> <a href=../../ui-templating/ class=md-nav__link> <span class=md-ellipsis> UI Templating </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Configuration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../configuration/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> CLI </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> JWT Auth Toolkit </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> JWT Auth Toolkit </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#running-the-setup-command class=md-nav__link> <span class=md-ellipsis> Running the setup command </span> </a> </li> <li class=md-nav__item> <a href=#artifacts-created-by-the-toolkit class=md-nav__link> <span class=md-ellipsis> Artifacts created by the toolkit </span> </a> </li> <li class=md-nav__item> <a href=#default-routes-and-behaviour class=md-nav__link> <span class=md-ellipsis> Default routes and behaviour </span> </a> </li> <li class=md-nav__item> <a href=#verifying-the-setup class=md-nav__link> <span class=md-ellipsis> Verifying the setup </span> </a> </li> <li class=md-nav__item> <a href=#configuration-knobs class=md-nav__link> <span class=md-ellipsis> Configuration knobs </span> </a> </li> <li class=md-nav__item> <a href=#maintaining-the-user-store class=md-nav__link> <span class=md-ellipsis> Maintaining the user store </span> </a> </li> <li class=md-nav__item> <a href=#rerunning-the-toolkit-safely class=md-nav__link> <span class=md-ellipsis> Rerunning the toolkit safely </span> </a> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next steps </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../tasks/ class="md-nav__link "> <span class=md-ellipsis> Tasks </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Tasks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tasks/config-validation-ci/ class=md-nav__link> <span class=md-ellipsis> Config Validation in CI </span> </a> </li> <li class=md-nav__item> <a href=../../tasks/benchmarks-baseline-dataset/ class=md-nav__link> <span class=md-ellipsis> Benchmarks Baseline Dataset </span> </a> </li> <li class=md-nav__item> <a href=../../tasks/upgrade-guide-config-deprecations/ class=md-nav__link> <span class=md-ellipsis> Upgrade Guide Config Deprecations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../benchmarks/ class="md-nav__link "> <span class=md-ellipsis> Benchmarks </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Benchmarks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../benchmarks/data/20240528-baseline/ class=md-nav__link> <span class=md-ellipsis> Baseline Dataset (2024-05-28) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../starters/ class=md-nav__link> <span class=md-ellipsis> Starters </span> </a> </li> <li class=md-nav__item> <a href=../../OpenSwoole-Compat-and-Fixes/ class=md-nav__link> <span class=md-ellipsis> Compatibility </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex> <span class=md-ellipsis> Upgrade </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Upgrade </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../upgrade/v1.0/ class=md-nav__link> <span class=md-ellipsis> Bamboo v1.0 Upgrade Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex> <span class=md-ellipsis> Roadmap </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Roadmap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../roadmap/v0.3-prep/ class=md-nav__link> <span class=md-ellipsis> v0.3 Prep </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/v0.4-prep/ class=md-nav__link> <span class=md-ellipsis> v0.4 Prep </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/v1.0-prep/ class=md-nav__link> <span class=md-ellipsis> v1.0 Prep </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#running-the-setup-command class=md-nav__link> <span class=md-ellipsis> Running the setup command </span> </a> </li> <li class=md-nav__item> <a href=#artifacts-created-by-the-toolkit class=md-nav__link> <span class=md-ellipsis> Artifacts created by the toolkit </span> </a> </li> <li class=md-nav__item> <a href=#default-routes-and-behaviour class=md-nav__link> <span class=md-ellipsis> Default routes and behaviour </span> </a> </li> <li class=md-nav__item> <a href=#verifying-the-setup class=md-nav__link> <span class=md-ellipsis> Verifying the setup </span> </a> </li> <li class=md-nav__item> <a href=#configuration-knobs class=md-nav__link> <span class=md-ellipsis> Configuration knobs </span> </a> </li> <li class=md-nav__item> <a href=#maintaining-the-user-store class=md-nav__link> <span class=md-ellipsis> Maintaining the user store </span> </a> </li> <li class=md-nav__item> <a href=#rerunning-the-toolkit-safely class=md-nav__link> <span class=md-ellipsis> Rerunning the toolkit safely </span> </a> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next steps </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=jwt-authentication-cli-toolkit>JWT Authentication CLI Toolkit<a class=headerlink href=#jwt-authentication-cli-toolkit title="Permanent link">&para;</a></h1> <p>Bamboo ships a JWT authentication starter that is provisioned by the <code>auth.jwt.setup</code> console command. This guide walks through what the command does, how to verify the generated scaffolding, and which knobs you can tune after the initial bootstrap.</p> <h2 id=prerequisites>Prerequisites<a class=headerlink href=#prerequisites title="Permanent link">&para;</a></h2> <ul> <li>A Bamboo application installed locally.</li> <li>PHP CLI access to run <code>php bin/bamboo</code> commands from the project root.</li> <li>File system write permissions so the command can manage <code>.env</code>, <code>etc/</code>, and <code>var/</code> artifacts.</li> </ul> <h2 id=running-the-setup-command>Running the setup command<a class=headerlink href=#running-the-setup-command title="Permanent link">&para;</a></h2> <p>Execute the setup command from the root of your project:</p> <div class=highlight><pre><span></span><code>php<span class=w> </span>bin/bamboo<span class=w> </span>auth.jwt.setup
</code></pre></div> <p>On success the command exits with code <code>0</code> and prints a checklist of the work it performed, followed by <code>JWT authentication scaffolding is ready to use.</code>【F:src/Console/Command/AuthJwtSetup.php†L31-L87】</p> <blockquote> <p><strong>Tip:</strong> The command is idempotent. You can rerun it at any time to ensure configuration drift has not occurred. Existing secrets, module registrations, and populated user stores are left intact.【F:src/Console/Command/AuthJwtSetup.php†L34-L87】【F:tests/Console/AuthJwtSetupCommandTest.php†L40-L76】</p> </blockquote> <h2 id=artifacts-created-by-the-toolkit>Artifacts created by the toolkit<a class=headerlink href=#artifacts-created-by-the-toolkit title="Permanent link">&para;</a></h2> <p>When you run <code>auth.jwt.setup</code>, Bamboo prepares the following assets:</p> <table> <thead> <tr> <th>Artifact</th> <th>Purpose</th> <th>Location</th> </tr> </thead> <tbody> <tr> <td>JWT secret</td> <td>Adds a random 64-character secret to <code>.env</code> (creating the file from <code>.env.example</code> if needed). Used for signing issued tokens.</td> <td><code>.env</code> via <code>AUTH_JWT_SECRET</code></td> </tr> <tr> <td>Auth config</td> <td>Publishes the JWT configuration stub that drives the module.</td> <td><code>etc/auth.php</code></td> </tr> <tr> <td>User store</td> <td>Creates a JSON user repository (default) and seeds an <code>admin</code> user (<code>password</code>). Alternate drivers (MySQL, PostgreSQL, Firebase, NoSQL) are scaffolded via configuration.</td> <td>JSON: <code>var/auth/users.json</code> (configurable)</td> </tr> <tr> <td>Module registration</td> <td>Ensures the <code>JwtAuthModule</code> is registered so routes and middleware load.</td> <td><code>etc/modules.php</code></td> </tr> </tbody> </table> <p>The setup command writes the env secret, copies the configuration stub, seeds the user store when empty, and registers the module if it is not already present.【F:src/Console/Command/AuthJwtSetup.php†L52-L233】 The JSON user store is only seeded when the file is missing or blank, preventing accidental overwrites of real accounts, while alternate drivers are left untouched so you can manage migrations externally.【F:src/Console/Command/AuthJwtSetup.php†L108-L233】</p> <p>Set <code>AUTH_JWT_STORAGE_DRIVER</code> to <code>mysql</code>, <code>pgsql</code>, <code>firebase</code>, or <code>nosql</code> before running the command to tailor <code>etc/auth.php</code> to your preferred backend. The generated configuration includes connection placeholders and schema guidance for each driver, while continuing to default to the JSON file store when unset.【F:stubs/auth/jwt-auth.php†L20-L181】【F:etc/auth.php†L20-L181】</p> <h2 id=default-routes-and-behaviour>Default routes and behaviour<a class=headerlink href=#default-routes-and-behaviour title="Permanent link">&para;</a></h2> <p>Registering the <code>JwtAuthModule</code> wires three HTTP endpoints into your application:</p> <table> <thead> <tr> <th>Method &amp; path</th> <th>Handler</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><code>POST /api/auth/register</code></td> <td><code>AuthController::register</code></td> <td>Optional—honours the <code>auth.jwt.registration.enabled</code> flag. Returns a token and sanitized user payload after creating the account.</td> </tr> <tr> <td><code>POST /api/auth/login</code></td> <td><code>AuthController::login</code></td> <td>Validates credentials and issues a signed JWT containing the user name and roles.</td> </tr> <tr> <td><code>GET /api/auth/profile</code></td> <td><code>AuthController::profile</code></td> <td>Protected by the <code>auth.jwt</code> middleware alias. Returns the authenticated user and decoded claims.</td> </tr> </tbody> </table> <p>These routes are registered during module boot, and the middleware alias <code>auth.jwt</code> becomes available for protecting additional routes in your project.【F:src/Auth/Jwt/JwtAuthModule.php†L31-L75】 Requests hitting the controller use the JSON user repository and token service that were bound in the service container.【F:src/Auth/Jwt/AuthController.php†L11-L120】</p> <h2 id=verifying-the-setup>Verifying the setup<a class=headerlink href=#verifying-the-setup title="Permanent link">&para;</a></h2> <p>After running the setup command:</p> <ol> <li>Start the HTTP server (<code>php bin/bamboo http.serve</code>).</li> <li>Make a login request with the seeded admin user: <div class=highlight><pre><span></span><code>curl<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span>http://localhost:8080/api/auth/login<span class=w> </span><span class=se>\</span>
<span class=w>  </span>-H<span class=w> </span><span class=s1>&#39;Content-Type: application/json&#39;</span><span class=w> </span><span class=se>\</span>
<span class=w>  </span>-d<span class=w> </span><span class=s1>&#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;password&quot;}&#39;</span>
</code></pre></div></li> <li>Copy the <code>token</code> value from the response and call the profile endpoint: <div class=highlight><pre><span></span><code>curl<span class=w> </span>http://localhost:8080/api/auth/profile<span class=w> </span><span class=se>\</span>
<span class=w>  </span>-H<span class=w> </span><span class=s1>&#39;Authorization: Bearer &lt;token&gt;&#39;</span>
</code></pre></div></li> <li>Confirm the response contains the sanitized user payload and <code>claims</code> extracted from the JWT.【F:src/Auth/Jwt/AuthController.php†L57-L118】</li> </ol> <p>If you enabled registration, you can exercise the register endpoint with the same pattern. Duplicate usernames receive a <code>409</code> response, and malformed payloads are rejected with descriptive error codes.【F:src/Auth/Jwt/AuthController.php†L25-L56】</p> <h2 id=configuration-knobs>Configuration knobs<a class=headerlink href=#configuration-knobs title="Permanent link">&para;</a></h2> <p>All JWT settings are stored in <code>etc/auth.php</code>, which reads defaults from environment variables. Key options include:</p> <ul> <li><code>AUTH_JWT_SECRET</code> – signing key used by <code>JwtTokenService</code>; rotate this in production deployments.【F:stubs/auth/jwt-auth.php†L5-L38】【F:src/Auth/Jwt/JwtAuthModule.php†L19-L40】</li> <li><code>AUTH_JWT_TTL</code> – token lifetime in seconds (default <code>3600</code>).【F:stubs/auth/jwt-auth.php†L10-L33】【F:src/Auth/Jwt/JwtAuthModule.php†L23-L34】</li> <li><code>AUTH_JWT_ISSUER</code> / <code>AUTH_JWT_AUDIENCE</code> – metadata included in tokens for validation.【F:stubs/auth/jwt-auth.php†L14-L33】【F:src/Auth/Jwt/JwtAuthModule.php†L23-L34】</li> <li><code>AUTH_JWT_STORAGE_DRIVER</code> – selects the user repository backend (<code>json</code>, <code>mysql</code>, <code>pgsql</code>, <code>firebase</code>, <code>nosql</code>). The generated configuration surfaces connection placeholders and schema guidance for each driver while defaulting to JSON when unset.【F:stubs/auth/jwt-auth.php†L20-L181】【F:etc/auth.php†L20-L181】</li> <li><code>AUTH_JWT_USER_STORE</code> – path to the JSON store when the JSON driver is active; point this to shared storage in clustered environments.【F:stubs/auth/jwt-auth.php†L20-L44】【F:src/Auth/Jwt/JwtAuthModule.php†L15-L28】</li> <li>Driver-specific environment variables populate the nested configuration:</li> <li>MySQL: <code>AUTH_JWT_MYSQL_DSN</code>, <code>AUTH_JWT_MYSQL_USERNAME</code>, <code>AUTH_JWT_MYSQL_PASSWORD</code>, <code>AUTH_JWT_MYSQL_TABLE</code>.【F:stubs/auth/jwt-auth.php†L40-L89】</li> <li>PostgreSQL: <code>AUTH_JWT_PGSQL_DSN</code>, <code>AUTH_JWT_PGSQL_USERNAME</code>, <code>AUTH_JWT_PGSQL_PASSWORD</code>, <code>AUTH_JWT_PGSQL_TABLE</code>.【F:stubs/auth/jwt-auth.php†L91-L127】</li> <li>Firebase: <code>AUTH_JWT_FIREBASE_CREDENTIALS</code>, <code>AUTH_JWT_FIREBASE_DATABASE_URL</code>, <code>AUTH_JWT_FIREBASE_COLLECTION</code>.【F:stubs/auth/jwt-auth.php†L129-L152】</li> <li>NoSQL document stores: <code>AUTH_JWT_NOSQL_CONNECTION</code>, <code>AUTH_JWT_NOSQL_DATABASE</code>, <code>AUTH_JWT_NOSQL_COLLECTION</code>.【F:stubs/auth/jwt-auth.php†L154-L181】</li> <li><code>AUTH_JWT_ALLOW_REGISTRATION</code> – toggles the <code>/register</code> endpoint. The controller checks this flag before accepting new accounts.【F:stubs/auth/jwt-auth.php†L26-L37】【F:src/Auth/Jwt/AuthController.php†L33-L55】</li> </ul> <p>Updating the env variables and reloading your server is enough—the module resolves configuration at runtime.</p> <h2 id=maintaining-the-user-store>Maintaining the user store<a class=headerlink href=#maintaining-the-user-store title="Permanent link">&para;</a></h2> <p>By default user records live in a JSON array with bcrypt password hashes. The setup command seeds an admin user with a random ID, email placeholder, and <code>admin</code> role metadata.【F:src/Console/Command/AuthJwtSetup.php†L108-L233】 When you switch drivers, apply the schema guidance in <code>etc/auth.php</code> to your database and seed records using your preferred tooling.【F:etc/auth.php†L20-L181】</p> <p>To manage real accounts:</p> <ul> <li>Replace the default password immediately after bootstrapping.</li> <li>Use the <code>/register</code> endpoint or edit the JSON file directly (remember to hash passwords with <code>password_hash()</code> if you script changes).</li> <li>Backup and secure the user store when deploying to shared environments.</li> </ul> <h2 id=rerunning-the-toolkit-safely>Rerunning the toolkit safely<a class=headerlink href=#rerunning-the-toolkit-safely title="Permanent link">&para;</a></h2> <p>Rerunning <code>php bin/bamboo auth.jwt.setup</code> performs drift correction without deleting existing users:</p> <ul> <li>The command respects existing <code>AUTH_JWT_SECRET</code> values, only generating a new secret when the entry is missing or blank.【F:src/Console/Command/AuthJwtSetup.php†L72-L105】</li> <li>User stores that already contain data are preserved, and non-JSON backends are never mutated by the command.【F:src/Console/Command/AuthJwtSetup.php†L108-L233】</li> <li>Module registration is skipped when <code>JwtAuthModule</code> is already listed.【F:src/Console/Command/AuthJwtSetup.php†L304-L347】</li> </ul> <p>This makes the command safe to wire into provisioning scripts, CI smoke tests, or recovery playbooks.</p> <h2 id=next-steps>Next steps<a class=headerlink href=#next-steps title="Permanent link">&para;</a></h2> <ul> <li>Enforce HTTPS and secure token storage (for example, using <code>Authorization</code> headers in front-end clients).</li> <li>Extend the controller or middleware to add refresh tokens, revoke lists, or role-based access checks.</li> <li>Add contract tests that exercise your custom routes with the <code>auth.jwt</code> middleware to prevent regressions.</li> </ul> <p>With the CLI toolkit in place you can ship JWT-protected APIs from a fresh Bamboo install in minutes.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.expand", "navigation.indexes", "navigation.sections"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>